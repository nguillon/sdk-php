# PHP SDK for xtractor.io

PHP SDK for the [xtractor.io REST API](https://console.xtractor.io).

This SDK is automatically generated by [swagger-codegen](https://github.com/swagger-api/swagger-codegen) based on the [xtractor.io API specification](https://console.xtractor.io/scheme/api/latest.json).

## Requirements

- xtractor.io API Key: https://console.xtractor.io 
- PHP Version: >= `5.3.3`
- PHP Extensions: `curl`, `json`, `mbstring`

## Install

Download [latest version](https://github.com/Organiceme/xtractor.io-sdk-php/archive/master.zip) or a [specific release](https://github.com/Organiceme/xtractor.io-sdk-php/releases) and include in your project.

## Usage

### Example: Get semantics data for a document
```php
<?php

require_once __DIR__ . '/../autoload.php';

use Organizeme\Xtractor\SemanticsApi;
use Organizeme\Xtractor\ApiException;

$apiKey = '<YOUR_API_KEY>';
$file = __DIR__ . '/files/example.pdf';

try {
  $semanticsApi = new SemanticsApi();
  $semanticsApi->getApiClient()->getConfig()->addDefaultHeader('X-API-Key', $apiKey);
  $result = $semanticsApi->getDocumentSemantics($file);

  echo "<pre>\n";
  var_export($result);
  echo "</pre>\n";
}
catch (ApiException $e) {
  echo "<pre>\n";
  echo 'Caught exception: ', $e->getMessage(), "\n";
  echo 'HTTP status code: ', $e->getCode(), "\n";
  echo 'HTTP response headers: ', $e->getResponseHeaders(), "\n";
  echo 'HTTP response body: '; print_r($e->getResponseBody()); echo "\n";
  echo "</pre>\n";
}
```

### Example: Get item listing from gateway
```php
<?php

require_once __DIR__ . '/../autoload.php';

use Organizeme\Xtractor\GatewayApi;
use Organizeme\Xtractor\ApiException;
use Organizeme\Xtractor\Models\GatewayItemListPayload;

$apiKey = '<YOUR_API_KEY>';

try {
  $gatewayApi = new GatewayApi();
  $gatewayApi->getApiClient()->getConfig()->addDefaultHeader('X-API-Key', $apiKey);
  $payload = new GatewayItemListPayload([
    'type' => '<GATEWAY_TYPE>',
    'auth' => [
      'username' => '<YOUR_GATEWAY_USERNAME>',
      'password' => '<YOUR_GATEWAY_PASSWORD>'
    ]
  ]);
  $result = $gatewayApi->getGatewayItemList($payload);

  echo "<pre>\n";
  var_export($result);
  echo "</pre>\n";
}
catch (ApiException $e) {
  echo "<pre>\n";
  echo 'Caught exception: ', $e->getMessage(), "\n";
  echo 'HTTP status code: ', $e->getCode(), "\n";
  echo 'HTTP response headers: ', $e->getResponseHeaders(), "\n";
  echo 'HTTP response body: '; print_r($e->getResponseBody()); echo "\n";
  echo "</pre>\n";
}
```

### Example: Get item content from gateway
```php
<?php

require_once __DIR__ . '/../autoload.php';

use Organizeme\Xtractor\GatewayApi;
use Organizeme\Xtractor\ApiException;
use Organizeme\Xtractor\Models\GatewayItemContentPayload;

$apiKey = '<YOUR_API_KEY>';

try {
  $gatewayApi = new GatewayApi();
  $gatewayApi->getApiClient()->getConfig()->addDefaultHeader('X-API-Key', $apiKey);
  $payload = new GatewayItemContentPayload([
    'type' => '<GATEWAY_TYPE>',
    'id' => '<GATEWAY_ITEM_ID>',
    'auth' => [
      'username' => '<YOUR_GATEWAY_USERNAME>',
      'password' => '<YOUR_GATEWAY_PASSWORD>'
    ]
  ]);
  $result = $gatewayApi->getGatewayItemContent($payload);

  echo "<pre>\n";
  var_export($result);
  echo "</pre>\n";
}
catch (ApiException $e) {
  echo "<pre>\n";
  echo 'Caught exception: ', $e->getMessage(), "\n";
  echo 'HTTP status code: ', $e->getCode(), "\n";
  echo 'HTTP response headers: ', $e->getResponseHeaders(), "\n";
  echo 'HTTP response body: '; print_r($e->getResponseBody()); echo "\n";
  echo "</pre>\n";
}
```

## Building the SDK

Building a new version of the SDK from the latest xtractor.io JSON Spec is as easy as running the build script:

```
./build/build.sh
```

### Important Disclaimer:

The swagger build currently does not support "null" values. As a result, the Organizeme\Xtractor\ObjectSerializer class
triggers an error when serializing the API response:

```
PHP Fatal error:  Class 'null' not found in /path/lib/ObjectSerializer.php on line 211
PHP Stack trace:
PHP   1. {main}() /path/examples/test.php:0
PHP   2. Organizeme\Xtractor\SemanticsApi->getDocumentSemantics() /path/examples/test.php:14
PHP   3. Organizeme\Xtractor\ObjectSerializer->deserialize() /path/lib/SemanticsApi.php:202
PHP   4. Organizeme\Xtractor\ObjectSerializer->deserialize() /path/lib/ObjectSerializer.php:221
PHP   5. Organizeme\Xtractor\ObjectSerializer->deserialize() /path/lib/ObjectSerializer.php:221
PHP   6. Organizeme\Xtractor\ObjectSerializer->deserialize() /path/lib/ObjectSerializer.php:191
```

The error has been addressed in a PR: https://github.com/swagger-api/swagger-codegen/pull/1560

In the meantime, you need to patch ObjectSerializer.php yourself after every build.
Find the following line:

```
} elseif (in_array($class, array('integer', 'int', 'void', 'number', 'object', 'double', 'float', 'byte', 'DateTime', 'string', 'mixed', 'boolean', 'bool'))) {
```

and add ```'null'``` to the list. The result should look like this:

```
} elseif (in_array($class, array('integer', 'int', 'void', 'number', 'object', 'double', 'float', 'byte', 'DateTime', 'string', 'mixed', 'boolean', 'bool', 'null'))) {
```
